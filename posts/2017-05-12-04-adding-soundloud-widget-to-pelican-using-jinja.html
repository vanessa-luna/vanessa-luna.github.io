<!DOCTYPE html>
<html lang="en">
<head>
	<title>Adding SoundCloud embed widget to Pelican using Jinja and Javascript | Vanessa & Luna</title>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel=icon href=https://res.cloudinary.com/vanessa-luna/image/upload/images/favicon.png>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">


<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-100867520-1', 'auto');
		ga('send', 'pageview');
</script>
	<link rel="stylesheet" href="http://vanessa-luna.life/theme/css/article.min.css?e420b04d">
	
    <script type="text/javascript">
      function gh(s) { return parseInt(s.replace(/.+x/, '')) }
      var imageSizes = [{name:"huge", h:gh("?x1080")}, {name:"medium", h:gh("?x480")}, {name:"tiny", h:gh("?x144")}, {name:"large", h:gh("?x720")}, {name:"smaller", h:gh("?x240")}, {name:"small", h:gh("?x360")}]
      imageSizes.sort(function(a,b) {return (a.h > b.h) ? -1 : ((b.h > a.h) ? 1 : 0);} );

      function imgUrlByHeight(filename, h) {
        var chosenSize = imageSizes[0]; //start at smallest size
        for (var i = 0; i < imageSizes.length; i++){ // redo smallest to calculate abs
          var curSize = imageSizes[i];
          curSize.abs = Math.abs(h - curSize.h);
          if (curSize.abs <= chosenSize.abs) chosenSize = curSize;
        }
        return "url(https://res.cloudinary.com/vanessa-luna/image/upload/thumb/" + chosenSize.name + "/" + filename;
      }
    </script>
</head>
<body>
	<div class="sidebar">
		<div class="sidebar" id='sidebar-bg' style="background-image:url('https://res.cloudinary.com/vanessa-luna/image/upload/thumb/huge/backgrounds/26cover.jpg')">
			<!-- dynamically load a different bg image -->
			<script type="text/javascript">
			    document.addEventListener("DOMContentLoaded", function (e) {
					var sb = document.getElementById('sidebar-bg');
					var filename = "backgrounds/" + (parseInt((Math.random() * 26 ))) + "cover.jpg)"
					sb.style.backgroundImage = imgUrlByHeight(filename, sb.clientHeight);
					sb.style.backgroundPosition = parseInt((Math.random() * 100)) + "%";
			    });
				function chooseIcon(list){ return list[parseInt(Math.random()*list.length)]; }
			</script>
		</div>
		<div class="headline">
			<a id="secret" href='/s' tabindex="-1"></a>
			<a id="home" href="/">
				<img class="profile-picture" src="https://res.cloudinary.com/vanessa-luna/image/upload/images/favicon.png"></img>
				<h1>Vanessa &#xe80a; Luna</h1>
			</a>
			<p class="subtitle">A reflection of your experience: as moonlight is a reflection of sunlight.</p>
		</div>
		<nav class="menu">
			<div class="menu-item ">
				<a href="/">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Home").className = "fa fa-" +  chooseIcon(["flight","rocket","fighter-jet","space-shuttle"]); });
							</script>
							<i id="icon-Home" class="fa fa-flight"></i>
						</div>
						<span class='name'>Home</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/categories">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Categories").className = "fa fa-" +  chooseIcon(["leaf","feather","tree-2"]); });
							</script>
							<i id="icon-Categories" class="fa fa-leaf"></i>
						</div>
						<span class='name'>Categories</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/archives/">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Archive").className = "fa fa-" +  chooseIcon(["hourglass-3","hourglass-2","hourglass-1"]); });
							</script>
							<i id="icon-Archive" class="fa fa-hourglass-3"></i>
						</div>
						<span class='name'>Archive</span>
					</div>
				</a>
			</div>
			<div class="menu-item spacer">
			</div>
			<div class="menu-item ">
				<a href="/images">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Gallery").className = "fa fa-" +  chooseIcon(["picture","eye-off","eye"]); });
							</script>
							<i id="icon-Gallery" class="fa fa-picture"></i>
						</div>
						<span class='name'>Gallery</span>
					</div>
				</a>
			</div>
			<div class="menu-item spacer">
			</div>
			<div class="menu-item ">
				<a href="/about">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-About").className = "fa fa-" +  chooseIcon(["dot-circled","sun-1"]); });
							</script>
							<i id="icon-About" class="fa fa-dot-circled"></i>
						</div>
						<span class='name'>About</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/contact">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Contact").className = "fa fa-" +  chooseIcon(["thumbs-up","hand-paper-o","hand-scissors-o","hand-grab-o"]); });
							</script>
							<i id="icon-Contact" class="fa fa-thumbs-up"></i>
						</div>
						<span class='name'>Contact</span>
					</div>
				</a>
			</div>
		</nav>
	</div>
	<div class="content">
 <div class="min-height-full pad-content">
	<div class="post">
		<h1 class="post-title">Adding SoundCloud embed widget to Pelican using Jinja and Javascript</h1>
		<span class="post-date">web-dev ~ 2017-05-12</span>
		<br><br>

		<p>Another little project that took me a while to figure out was getting a SoundCloud widget on the page without loading right away. This is tricker than I hoped and I wish there was a way I could do this without Javascript. I am sure there is a way, but I have not found it yet. The secret may lie it <code>a:target</code> selector, but we'll see.
</p>
<h2 id="soundcloud-widget">SoundCloud widget</h2>
<p>There are three options to choose for the SoundCloud widget depending on your account type. I prefered the Smaller HTML5 one, compared to the one that loaded if I used the plugin <code>liquid_tags</code> for soundcloud. So I set off to make my own. I'm not ready to write a full fledged plugin yet so I opted for
Jinja</p>
<h2 id="how-it-works">How it works</h2>
<ul>
<li>custom metadata field for content <code>soundcloud</code></li>
<li>Jinja template which embeds the proper html</li>
<li>CSS to render things pretty</li>
</ul>
<h5 id="mypostmd">mypost.md</h5>
<div class="highlight"><pre><span></span>Title: My post
soundcloud: 0123456

listen to this cool song!
</pre></div>


<p>The soundcloud metadata variable should be simply the id of the song you want the widget to load.</p>
<h5 id="fragmentssoundcloudhtml-jinja-template">fragments/soundcloud.html - Jinja template</h5>
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">article.soundcloud</span> <span class="k">is</span> <span class="nf">defined</span> <span class="k">and</span> <span class="nv">article.soundcloud</span><span class="o">|</span><span class="nf">length</span> <span class="o">&gt;</span> <span class="m">0</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;script&gt;</span>
<span class="x">  function loadSoundCloud() {</span>
<span class="x">    document.getElementById(&#39;soundcloud&#39;).innerHTML = &quot;&lt;iframe name=&#39;soundcloud2&#39; width=&#39;100%&#39; height=&#39;122px&#39; scrolling=&#39;no&#39; frameborder=&#39;no&#39; src=&#39;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">article.soundcloud</span> <span class="cp">}}</span><span class="x"> &amp;amp;color=ff5500&amp;amp;auto_play=false&amp;amp;hide_related=true&amp;amp;show_comments=false&amp;amp;show_user=false&amp;amp;show_reposts=false&#39;&gt;&lt;/iframe&gt;&quot;</span>
<span class="x">  }</span>
<span class="x">&lt;/script&gt;</span>
<span class="x">&lt;div markdown id=&quot;soundcloud&quot; onclick=&quot;loadSoundCloud()&quot;&gt;</span>
<span class="x">  &lt;div class=&quot;soundcloud-loader&quot;&gt;&lt;/div&gt;</span>
<span class="x">&lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>


<p>Above you can see the first line ensures that there is at least some soundcloud variable in the metadata.</p>
<p>Next, I add some javascript that adds a function to create an iframe with the proper url</p>
<p>The function replaces the innerHTML of the outer <code>&lt;div&gt;</code> that holds the placeholder image.</p>
<p>The added div, when clicked on runs the javascript function.</p>
<h5 id="soundcloud-css">soundcloud css</h5>
<div class="highlight"><pre><span></span><span class="p">.</span><span class="nc">soundcloud-loader</span> <span class="p">{</span>
  <span class="k">display</span><span class="p">:</span><span class="kc">block</span><span class="p">;</span>
  <span class="k">box-sizing</span><span class="p">:</span> <span class="kc">border-box</span><span class="p">;</span>
  <span class="k">width</span><span class="p">:</span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
  <span class="k">height</span><span class="p">:</span><span class="mi">122</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">max-height</span><span class="p">:</span> <span class="mi">122</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="kc">black</span><span class="p">;</span>
  <span class="k">border-radius</span><span class="p">:</span> <span class="mi">4</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">background-image</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s1">&#39;/images/soundcloud-loader.jpg&#39;</span><span class="p">);</span>
  <span class="k">background-position</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
  <span class="k">background-repeat</span><span class="p">:</span> <span class="kc">no-repeat</span><span class="p">;</span>
  <span class="k">background-size</span><span class="p">:</span> <span class="kc">contain</span><span class="p">;</span>
  <span class="k">cursor</span><span class="p">:</span> <span class="kc">pointer</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">soundcloud-loader</span><span class="p">:</span><span class="nd">hover</span> <span class="p">{</span>
  <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="mh">#ff7256</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>You can see that I'm simply adding a background, a border, and making it a certain size. On hover, it highlights the border. In hindsight, I coudl have done this very differently, however I tried to start with a css only method, but upon failure, I opted for the easiest next solution. </p>
<h2 id="future-updates">Future updates</h2>
<p>I plan to write a plugin that allows me to place custom tag inside my content to put the soundcloud widget where I please in the document. At the moment, it always appears in the same place: the end of the content.</p>
<p>I also hope to find a way to do with without js since, if it can be done, it should, to benefit users who have js turned off. However I don't know what would happen if you load the widget without js. So I'm merely speculating about its worth.</p>

	</div>








      <div class="pagination">




































































































































































































        <div class="pagination-item">
    <a class="box" href="/posts/2017-05-12-03-using-webassets-in-pelican-to-serve-the-smallest-css-files.html">
        <span class="newer">Newer</span>
    </a>
</div>


        <span class="pagination-spacer"></span>

        <div class="pagination-item">
    <a class="box" href="/posts/2017-05-12-05-using-tables-in-markdown-in-pelican.html">
        <span class="older">Older</span>
    </a>
</div>





































      </div>
<div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comments</a> are loading... I hope ;)</div>
<script>
hcb_user = {
    no_comments_msg: 'Be the first to leave a comment',
    // submit form
    comments_header : 'Comments',
    name_label : 'Name (optional)',
    email_label:'Email (optional)',
    website_label:'Website (optional)',
    content_label: 'Message',
    submit : 'Submit',
    add:'Leave a comment',
    again: 'Post another comment',
    subscribe:'subscribe (email updates)',
    // user actions
    logout_link : '<img title="log out" src="//www.htmlcommentbox.com/static/images/door_out.png" alt="[logout]" class="hcb-icon"/>',
    admin_link : '<img src="//www.htmlcommentbox.com/static/images/door_in.png" alt="[login]" class="hcb-icon"/>',
    del_link : '<img src="//www.htmlcommentbox.com/static/images/door_in.png" alt="[login]" class="hcb-icon"/>',
    rss:'<img src="//www.htmlcommentbox.com/static/images/feed.png" class="hcb-icon" alt="rss"/> ',
    // comment body
    said:'',
    anonymous:'anon',
    mod_label:'(owner)',
    // dates
    days_ago:'days',
    hours_ago:'hours',
    minutes_ago:'mins',
    within_the_last_minute:'<1 min',
    // comment actions
    reply:"<i class='fa fa-reply'></i> reply",
    flag:"<i class='fa fa-flag-filled'></i> flag",
    like:"",//"<i class='fa fa-thumbs-up-1'></i> like",
    are_you_sure:'Really flag this comment as inappropriate?',
    // pagination
    prev_page: "<a><i class='fa fa-angle-double-left'></i> Newer </a>",
    showing:'comments',
    to:'-',
    next_page: "<a> Older <i class='fa fa-angle-double-right'></i> </a>",

    msg_thankyou:'<span class="success-span">You left a comment!</span>',
    msg_approval:'<span class="info-span">Thank you for commenting! Your comment will appear once approved by a moderator.</span>',
    msg_approval_required:'<span class="info-span">Thank you for commenting! Your comment will appear once approved by a moderator.</span>',

    err_bad_html:'<span class="warning-span">Your comment contained bad html.</span>',
    err_bad_email:'<span class="warning-span">Please enter a valid email address.</span>',
    err_too_frequent:'<span class="warning-span">You must wait a few seconds between posting comments.</span>',
    err_comment_empty:'<span class="warning-span">Cannot leave empty comments!</span>',
    err_denied:'<span class="success">Your comment was not accepted.</span>',

    //SETTINGS
    MAX_CHARS: 8192,
    PAGE:"posts/2017-05-12-04-adding-soundloud-widget-to-pelican-using-jinja.html",
    RELATIVE_DATES:true
};
</script>
<script type="text/javascript" id="hcb"> /*<!--*/
    if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="//www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24aIzV1Bc59Aa3mSLIqa22X%2F"+"&opts=17167&num=5&ts=1508972406887");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
<noscript>
    <style>#HCB_comment_box { display:none;}</style>
    <div>
        <h3>Comments</h3>
        <p class="warning-block">Enable Javascript to view or write comments</p>
    </div>
</noscript>
</div>
        <div class="footer">
            <a href="/licenses">licenses</a> <i class="fa fa-star"></i>
            <i class="fa fa-copyright"></i> 2017 Vanessa & Luna
            <i class="fa fa-star"></i> built on <a href="http://getpelican.com" target="_blank">pelican</a>
        </div>
	</div>
</body>
</html>