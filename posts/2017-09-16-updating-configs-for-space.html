<!DOCTYPE html>
<html lang="en">
<head>
	<title>I updated my build process to save 2gb of space lol | Vanessa & Luna</title>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <link rel=icon href=https://res.cloudinary.com/vanessa-luna/image/upload/images/favicon.png>
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">


<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-100867520-1', 'auto');
		ga('send', 'pageview');
</script>
	<link rel="stylesheet" href="https://vanessa-luna.github.io/theme/css/article.min.css?790838c1">
	
    <script type="text/javascript">
      function gh(s) { return parseInt(s.replace(/.+x/, '')) }
      var imageSizes = [{name:"huge", h:gh("?x1080")}, {name:"medium", h:gh("?x480")}, {name:"tiny", h:gh("?x144")}, {name:"large", h:gh("?x720")}, {name:"smaller", h:gh("?x240")}, {name:"small", h:gh("?x360")}]
      imageSizes.sort(function(a,b) {return (a.h > b.h) ? -1 : ((b.h > a.h) ? 1 : 0);} );

      function imgUrlByHeight(filename, h) {
        var chosenSize = imageSizes[0]; //start at smallest size
        for (var i = 0; i < imageSizes.length; i++){ // redo smallest to calculate abs
          var curSize = imageSizes[i];
          curSize.abs = Math.abs(h - curSize.h);
          if (curSize.abs <= chosenSize.abs) chosenSize = curSize;
        }
        return "url(https://res.cloudinary.com/vanessa-luna/image/upload/thumb/" + chosenSize.name + "/" + filename;
      }
    </script>
</head>
<body>
	<div class="sidebar">
		<div class="sidebar" id='sidebar-bg' style="background-image:url('https://res.cloudinary.com/vanessa-luna/image/upload/thumb/huge/backgrounds/25cover.jpg')">
			<!-- dynamically load a different bg image -->
			<script type="text/javascript">
			    document.addEventListener("DOMContentLoaded", function (e) {
					var sb = document.getElementById('sidebar-bg');
					var filename = "backgrounds/" + (parseInt((Math.random() * 25 ))) + "cover.jpg)"
					sb.style.backgroundImage = imgUrlByHeight(filename, sb.clientHeight);
					sb.style.backgroundPosition = parseInt((Math.random() * 100)) + "%";
			    });
				function chooseIcon(list){ return list[parseInt(Math.random()*list.length)]; }
			</script>
		</div>
		<div class="headline">
			<a id="secret" href='/s' tabindex="-1"></a>
			<a id="home" href="/">
				<img class="profile-picture" src="https://res.cloudinary.com/vanessa-luna/image/upload/images/favicon.png"></img>
				<h1>Vanessa &#xe80a; Luna</h1>
			</a>
			<p class="subtitle">A reflection of your experience: as moonlight is a reflection of sunlight.</p>
		</div>
		<nav class="menu">
			<div class="menu-item ">
				<a href="/">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Home").className = "fa fa-" +  chooseIcon(["flight","rocket","fighter-jet","space-shuttle"]); });
							</script>
							<i id="icon-Home" class="fa fa-flight"></i>
						</div>
						<span class='name'>Home</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/categories">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Categories").className = "fa fa-" +  chooseIcon(["leaf","feather","tree-2"]); });
							</script>
							<i id="icon-Categories" class="fa fa-leaf"></i>
						</div>
						<span class='name'>Categories</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/archives/">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Archive").className = "fa fa-" +  chooseIcon(["hourglass-3","hourglass-2","hourglass-1"]); });
							</script>
							<i id="icon-Archive" class="fa fa-hourglass-3"></i>
						</div>
						<span class='name'>Archive</span>
					</div>
				</a>
			</div>
			<div class="menu-item spacer">
			</div>
			<div class="menu-item ">
				<a href="/images">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Gallery").className = "fa fa-" +  chooseIcon(["picture","eye-off","eye"]); });
							</script>
							<i id="icon-Gallery" class="fa fa-picture"></i>
						</div>
						<span class='name'>Gallery</span>
					</div>
				</a>
			</div>
			<div class="menu-item spacer">
			</div>
			<div class="menu-item ">
				<a href="/about">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-About").className = "fa fa-" +  chooseIcon(["dot-circled","sun-1"]); });
							</script>
							<i id="icon-About" class="fa fa-dot-circled"></i>
						</div>
						<span class='name'>About</span>
					</div>
				</a>
			</div>
			<div class="menu-item ">
				<a href="/contact">
					<div class="menu-item-content">
						<div class='icon'>
							<script type="text/javascript">
								document.addEventListener("DOMContentLoaded", function (e) { document.getElementById("icon-Contact").className = "fa fa-" +  chooseIcon(["thumbs-up","hand-paper-o","hand-scissors-o","hand-grab-o"]); });
							</script>
							<i id="icon-Contact" class="fa fa-thumbs-up"></i>
						</div>
						<span class='name'>Contact</span>
					</div>
				</a>
			</div>
		</nav>
	</div>
	<div class="content">
 <div class="min-height-full pad-content">
	<div class="post">
		<h1 class="post-title">I updated my build process to save 2gb of space lol</h1>
		<span class="post-date">web-dev ~ 2017-09-16</span>
		<br><br>

		<p>So I'm on a roll huh? Avoiding all the important stuff and working on my website too much... Well, when I'm stuck in bed because I hurt it's better than gaming or binge watching. I should finally internalize that. Anyway.</p>
<p>Until now, I had a folder that held the raw content of the website. A folder to hold the output of my testing setup. And another folder for the production output. This is bad. Because I had almost 2gb of raw images. I had all these images copied raw in all three places, plus the 250mb of resized versions. I was using too much space. So I fixed that, somewhat.</p>
<h2 id="in-short">In Short</h2>
<p>To save space from duplicated images, I created a separate config that only handled the processing of images. This config would always output to my production output folder. Then I created symlinks from the production output to the dev-output folder. I then took out any processing of images from my other configs.</p>
<p>Let me show you.</p>
<h2 id="thumbnail_confpy">thumbnail_conf.py</h2>
<p>So what's important about the below gist is that:</p>
<div class="highlight"><pre><span></span>* I ensure through excludes that Pelican doesn&#39;t copy anything over
* I turn off every feature I can by setting *_save_as = False
* I ensure feeds are off
</pre></div>


<p>The only things that happen now with this configuration is copy the images folder over and run the thumbnailer plugin.</p>
<script src="https://gist.github.com/vanessa-luna/93b34a74f86c64cad7696cd00ed3d408.js"></script>

<p>I imagine there are other ways to take care of this that don't force you to keep updating or copying over the folders. If I were to put my images in a different folder from the other content it might be cleaner. Maybe for another day.</p>
<p><em>Note</em> that the configuration of the thumbnailer plugin is not above. It still resides in the blog_conf I have. This is because I use the configruations of this plugin to generate some javascript which determines which size image to load for the sidebar. Therefore the blog_conf needs it to function. Remember, most everything is loaded from the root config blog_conf.</p>
<h2 id="blog_confpy-and-second_confpy">blog_conf.py and second_conf.py</h2>
<p>I also turned off processing of the images in these configs by adding images to the excludes and removing the thumbnailer plugin from the list of active plugins.</p>
<div class="highlight"><pre><span></span><span class="n">STATIC_EXCLUDES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">]</span>

<span class="n">PLUGINS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">,</span>                  <span class="c1"># specify summary in content</span>
    <span class="s1">&#39;liquid_tags.img&#39;</span><span class="p">,</span>          <span class="c1"># allows {% img %} in content</span>
    <span class="s1">&#39;liquid_tags.youtube&#39;</span><span class="p">,</span>      <span class="c1"># allows {% youtube %} in content</span>
    <span class="s1">&#39;liquid_tags.soundcloud&#39;</span><span class="p">,</span>   <span class="c1"># allows {% soundcloud %} in content</span>
    <span class="s1">&#39;extract_toc&#39;</span><span class="p">,</span>              <span class="c1"># can render table of contents from post</span>
    <span class="s1">&#39;pelican-linkclass&#39;</span><span class="p">,</span>        <span class="c1"># indicator for links leaving domain</span>
    <span class="s1">&#39;pelicanfly&#39;</span><span class="p">,</span>               <span class="c1"># adds font awesome support</span>
    <span class="s1">&#39;assets&#39;</span><span class="p">,</span>                   <span class="c1"># adds compiler for assets</span>
    <span class="s1">&#39;gallery&#39;</span><span class="p">,</span>                  <span class="c1"># adds gallery support to content</span>
    <span class="s1">&#39;archives_per_category&#39;</span>     <span class="c1"># generates archive page per category</span>
<span class="p">]</span>
</pre></div>


<h2 id="devsh">dev.sh</h2>
<p>Inside my testing script I have made some updates.</p>
<p>I had to do a few things in here.</p>
<div class="highlight"><pre><span></span>* Add in another instance of Pelican running the thumbnail_conf
* Ensure the output folder for the thumbnails is in production
* Ensure the symlinks are created
</pre></div>


<script src="https://gist.github.com/vanessa-luna/07ee4a6c4bfa5c5e587c3fc53f72eb17.js"></script>

<h2 id="buildsh">build.sh</h2>
<p>The production script was even easier to update. Simply add another instance of Pelican with the right config</p>
<p>I also added a condition on the git commands, if anything is passed in it won't do git stuff, so I Can make sure I like what happened when I'm making changes</p>
<script src="https://gist.github.com/vanessa-luna/00e9815890b3344d2da9f81261a5fe0e.js"></script>

	</div>








      <div class="pagination">











































































        <div class="pagination-item">
    <a class="box" href="/posts/2017-09-16-modern-stoics.html">
        <span class="newer">Newer</span>
    </a>
</div>


        <span class="pagination-spacer"></span>

        <div class="pagination-item">
    <a class="box" href="/posts/2017-09-14-burning-memorabilia.html">
        <span class="older">Older</span>
    </a>
</div>





















































































































      </div>
<div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">Comments</a> are loading... I hope ;)</div>
<script>
hcb_user = {
    no_comments_msg: 'Be the first to leave a comment',
    // submit form
    comments_header : 'Comments',
    name_label : 'Name (optional)',
    email_label:'Email (optional)',
    website_label:'Website (optional)',
    content_label: 'Message',
    submit : 'Submit',
    add:'Leave a comment',
    again: 'Post another comment',
    subscribe:'subscribe (email updates)',
    // user actions
    logout_link : '<img title="log out" src="//www.htmlcommentbox.com/static/images/door_out.png" alt="[logout]" class="hcb-icon"/>',
    admin_link : '<img src="//www.htmlcommentbox.com/static/images/door_in.png" alt="[login]" class="hcb-icon"/>',
    del_link : '<img src="//www.htmlcommentbox.com/static/images/door_in.png" alt="[login]" class="hcb-icon"/>',
    rss:'<img src="//www.htmlcommentbox.com/static/images/feed.png" class="hcb-icon" alt="rss"/> ',
    // comment body
    said:'',
    anonymous:'anon',
    mod_label:'(owner)',
    // dates
    days_ago:'days',
    hours_ago:'hours',
    minutes_ago:'mins',
    within_the_last_minute:'<1 min',
    // comment actions
    reply:"<i class='fa fa-reply'></i> reply",
    flag:"<i class='fa fa-flag-filled'></i> flag",
    like:"",//"<i class='fa fa-thumbs-up-1'></i> like",
    are_you_sure:'Really flag this comment as inappropriate?',
    // pagination
    prev_page: "<a><i class='fa fa-angle-double-left'></i> Newer </a>",
    showing:'comments',
    to:'-',
    next_page: "<a> Older <i class='fa fa-angle-double-right'></i> </a>",

    msg_thankyou:'<span class="success-span">You left a comment!</span>',
    msg_approval:'<span class="info-span">Thank you for commenting! Your comment will appear once approved by a moderator.</span>',
    msg_approval_required:'<span class="info-span">Thank you for commenting! Your comment will appear once approved by a moderator.</span>',

    err_bad_html:'<span class="warning-span">Your comment contained bad html.</span>',
    err_bad_email:'<span class="warning-span">Please enter a valid email address.</span>',
    err_too_frequent:'<span class="warning-span">You must wait a few seconds between posting comments.</span>',
    err_comment_empty:'<span class="warning-span">Cannot leave empty comments!</span>',
    err_denied:'<span class="success">Your comment was not accepted.</span>',

    //SETTINGS
    MAX_CHARS: 8192,
    PAGE:"posts/2017-09-16-updating-configs-for-space.html",
    RELATIVE_DATES:true
};
</script>
<script type="text/javascript" id="hcb"> /*<!--*/
    if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="//www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24aIzV1Bc59Aa3mSLIqa22X%2F"+"&opts=17167&num=5&ts=1508972406887");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
<noscript>
    <style>#HCB_comment_box { display:none;}</style>
    <div>
        <h3>Comments</h3>
        <p class="warning-block">Enable Javascript to view or write comments</p>
    </div>
</noscript>
</div>
        <div class="footer">
            <a href="/licenses">licenses</a> <i class="fa fa-star"></i>
            <i class="fa fa-copyright"></i> 2017 Vanessa & Luna
            <i class="fa fa-star"></i> built on <a href="http://getpelican.com" target="_blank">pelican</a>
        </div>
	</div>
</body>
</html>